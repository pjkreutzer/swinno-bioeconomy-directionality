```{r}
library(dplyr)
library(ggplot2)
library(scales)
library(patchwork)
library(showtext)
library(paletteer)
library(rio)
library(here)
library(hrbrthemes)
library(stringr)

showtext_auto()
font_add_google("IBM Plex Sans", "IBMPlexSans")

theme_custom <- function() {
    ret <- hrbrthemes::theme_ipsum_ps(grid = "Y")
    ret <- ret + theme(axis.line.x = element_line(color = "black", linewidth = 0.5))
    ret
}
```


```{r}
bioeconomy_share <- import(here("data/modified/swinno_bioeconomy_share.csv"))
```


```{r}

plot_bioeconomy_stats <- function(df, y, yaxis_title) {
    ggplot(df, aes(x = year, y = .data[[y]])) +
        geom_area(color = "black", fill = "gray40", alpha = 0.5, linewidth = 1) +
        xlab("Year") +
        ylab(stringr::str_wrap(yaxis_title, width = 20)) +
        theme_custom()
}
```


```{r}
#| label: fig-n-bioeconomy
bioeconomy_plot <- plot_bioeconomy_stats(bioeconomy_share, "ma5_n_bioeconomy", "Forest Bioeconomy")
```


```{r}
#| label: fig-n-innovation

innovation_plot <- plot_bioeconomy_stats(bioeconomy_share, "ma5_n_innovation", "Total SWINNO")
```


```{r}
#| label: fig-share
share_plot <- plot_bioeconomy_stats(bioeconomy_share, "ma5_share_bioeconomy", "Forest Bioeconomy Share") + scale_y_continuous(label = percent)
share_plot
```


```{r}
#| label: fig-trends

innovation_trends_plot <- (innovation_plot + bioeconomy_plot) / share_plot + plot_annotation(tag_levels = "a") & theme(plot.margin = margin(
    t = 0,
    r = 1, # Right margin
    b = 0, # Bottom margin
    l = 0
))

innovation_trends_plot
ggsave(here("results/figures/innovation_trends.pdf"), width = 7, height = 5)
```
